---
- name: ansible-securehost | prereq | import fail2ban role
  import_role:
    name: robertdebock.fail2ban
  become: True

- name: ansible-securehost | prereq | import bootstrap role
  import_role:
    name: robertdebock.bootstrap
  become: True

- name: ansible-securehost | prereq | import epel role
  import_role:
    name: robertdebock.epel
  become: True

- name: ansible-securehost | prereq | retreive current machine ip
  setup:
  register: current_host_facts
  delegate_facts: true

- name: ansible-securehost | prereq | compute ip if preferred_nic is not set
  ansible.builtin.debug:
    msg: "{{ current_host_facts.ansible_facts['ansible_' + preferred_nic].ipv4.address if preferred_nic is defined else current_host_facts.ansible_facts.ansible_default_ipv4.address | default(current_host_facts.ansible_facts.ansible_all_ipv4_addresses[0]) }}"
  register: current_host_ip

- name: ansible-securehost | deps | retreive current hostname
  command: "hostname"
  changed_when: False
  register: current_hostname
